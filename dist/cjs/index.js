"use strict";const e="EasiCustomer/",s="EasiMalaysia/",i=(e,s,i)=>{switch(s.complete&&s.complete({errMsg:`${i}:complete`}),e.code){case 0:s.success&&s.success({errMsg:`${i}:ok`,result:e?.data});break;case 1:s.cancel&&s.cancel({errMsg:`${i}:cancel`});break;default:s.fail&&s.fail({errMsg:`${i}:fail`})}},a=(e,s,i,a)=>{(e=>{if(window.WebViewJavascriptBridge)return e(window.WebViewJavascriptBridge);if(document.addEventListener("WebViewJavascriptBridgeReady",(function(){e(window.WebViewJavascriptBridge)}),!1),window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];const s=document.createElement("iframe");s.style.display="none",s.src="https://__bridge_loaded__",document.documentElement.appendChild(s),setTimeout((function(){document.documentElement.removeChild(s)}),0)})((t=>{t.callHandler(`easi.${e}`,s,(s=>{"string"==typeof s&&(s=JSON.parse(s)),i(s,a,e)}))}))},t={state:0,data:{},completes:[]},n={config:e=>{e.debug&&console.log("config",e),a("login",{},(e=>{-1===e.code&&t.fail&&t.fail(),t.state=1;for(const e of t.completes)e();t.completes=[]}),e)},checkJsApi:()=>{},ready:e=>{0!==t.state?e&&e():t.completes.push(e)},error:e=>{-1===t.state?e&&e(t.data):t.fail=e},test:e=>{a("login",{},i,e)},getEnv:()=>{const i=navigator.userAgent,a=i.includes(e),t=i.includes(s),n=i.includes("Android")||i.includes("android")||i.includes("Linux"),c=i.includes("iPhone")||i.includes("iOS");return{ua:i,isEasi:a,isMalaysia:t,isAndroid:n,isIos:c,version:(i=>{const a=i.ua.split(" ");if(a.length>0){const t=i.isMalaysia?s:e;if(a[0].includes(t))return a[0].replace(t,"")}return null})({ua:i,isMalaysia:t})}}};module.exports=n;
